<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DHR Store</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>


<header>
    <h1>DHR Store</h1>
</header>

<!-- Floating Search Bar -->
<!-- Floating search icon -->
<div class="search-icon">
  <a href="index.html">
    <img src="https://purepng.com/public/uploads/large/search-icon-lob.png" alt="Search Icon"></a>
</div>

<!-- Hidden search bar that will appear when the search icon is clicked -->
<div class="search-container" id="searchContainer">
    <input type="text" id="searchInput" placeholder="Search for apps..." onkeyup="searchApps()">
</div>

<nav>
    <a href="index.html">Home</a>
    <a href="pri.html">Categories</a>
    <a href="#">Top Charts</a>
    <a href="pri.html">Premium</a>
</nav>
<div id="resultsContainer"></div>

<div class="app-details">
    <img src="https://raw.githubusercontent.com/Zenda-Cross/vega-app/refs/heads/main/assets/bootsplash/logo%404x.png" alt="App Icon" class="app-icon" style="background-color: black; background-radius: 5px;">
    <h2>Vega-Next</h2>
     <p>Category: Productivity</p>
    <p class="downloads-count">921+ downloads</p>
    
<!-- Rating -->
<div class="rating">
    <span id="user-rating">
        ★ ★ ★ ★ ★
    </span>
    <p class="total-ratings">5/5 (590 ratings)</p>
</div>
<input type="hidden" id="rating-value" value="0">
<button id="submit-rating">Submit Rating</button>
<div class="rating">
    <span class="star" data-value="1">★</span>
    <span class="star" data-value="2">★</span>
    <span class="star" data-value="3">★</span>
    <span class="star" data-value="4">★</span>
    <span class="star" data-value="5">★</span>
</div>
    
    <!-- Overview -->
    <h3>Overview</h3>
    <p class="description">
        Through this app you can watch newly released movies, web series, Netflix, Amazon prime video for free and also download them for free. There is no ad in this app. The UI of this app is advanced.This app comes with a good feature but consumes less data<br>Watch according web season, episode and release date<br>Also download according to watching<br>Dynamic UI system make advance<br>5000+ live TV channel</p>
    
    <h3>Screenshots</h3>
    <div class="screenshots">
     
        <img src="vgimage/Screenshot_2025-01-21-14-16-23-85_11fe5ff35dd1fae673697ec5eb78287f.jpg" alt="Screenshot 1" class="screenshot">
        <img src="vgimage/Screenshot_2024-12-11-07-48-24-57_11fe5ff35dd1fae673697ec5eb78287f.jpg" alt="Screenshot 2" class="screenshot">
        <img src="vgimage/Screenshot_2024-12-11-07-47-59-38_11fe5ff35dd1fae673697ec5eb78287f.jpg" alt="" class="screenshot">
        <img src="vgimage/Screenshot_2024-12-11-07-51-52-60_11fe5ff35dd1fae673697ec5eb78287f.jpg" alt="" class="screenshot">
        <img src="vgimage/Screenshot_2024-12-11-07-48-05-30_11fe5ff35dd1fae673697ec5eb78287f.jpg" alt="" class="screenshot">
        <img src="vgimage/IMG_20250121_142011.jpg" alt="6" class="screenshot">
        <img src="vgimage/IMG_20250121_142019.jpg" alt="7" class="screenshot">
        <img src="vgimage/IMG_20250121_142035.jpg" alt="8" class="screenshot">
        <img src="vgimage/IMG_20250121_142044.jpg" alt="9" class="screenshot">
        <img src="vgimage/IMG_20250121_142053.jpg" alt="10" class="screenshot">
          </div>
<h2>v3.3.0</h2>
    <a href="https://github.com/DHR-Store/Zenda-Cross-/raw/refs/heads/main/Apk/Vega-Next-arm64-v8a-release.apk?download=" class="download-btn" data-version="arm64-v8a">Download</a><p>for Modern 8+ android version/Android TV</p>
    <br>
      <a href="https://github.com/DHR-Store/Zenda-Cross-/raw/refs/heads/main/Apk/Vega-Next-armeabi-v7a-release.apk?download=" class="download-btn" data-version="armeabi-v7a">Download</a><p>for 7 android version</p>
    <br>
<a href="https://github.com/DHR-Store/Zenda-Cross-/raw/refs/heads/main/Apk/Vega-Next-universal-release.apk?download=" class="download-btn" data-version="universal">Download</a><p>Universal for every Devices</p>
    <a href="how.html" class="how-download">how to download</a>
    <a href="https://vegaapp.vercel.app/" class="download-btn">Try Vega</a>
</div>
    <!-- Modal for Enlarged Image -->
<div id="imageModal" class="modal">
    <span class="close" id="modalClose">&times;</span>
    <img class="modal-content" id="modalImage">
</div>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- Configuration ---
    const serverUrl = 'https://my-online-server-4tro.vercel.app';

    // --- Core Functions ---

    // Fetches download and rating data from the server and updates the UI
    const fetchStats = async () => {
        try {
            const response = await fetch(`${serverUrl}/api/data`);
            if (!response.ok) {
                throw new Error('Server connection failed.');
            }
            const data = await response.json();
            
            // Calculate and update total downloads
            const totalDownloads = Object.values(data.downloads).reduce((sum, count) => sum + count, 0);
            document.querySelector('.downloads-count').textContent = `${totalDownloads}+ downloads`;

            // Calculate and update average rating
            const totalRatings = Object.values(data.ratings).reduce((sum, count) => sum + count, 0);
            let averageRating = 0;
            if (totalRatings > 0) {
                const totalScore = (
                    (data.ratings['5'] * 5) +
                    (data.ratings['4'] * 4) +
                    (data.ratings['3'] * 3) +
                    (data.ratings['2'] * 2) +
                    (data.ratings['1'] * 1)
                );
                averageRating = totalScore / totalRatings;
            }

            document.querySelector('.total-ratings').textContent = `${averageRating.toFixed(1)}/5 (${totalRatings} ratings)`;

            // Set star rating display based on average
            const ratingStars = document.querySelectorAll('.star');
            ratingStars.forEach(star => {
                const starValue = parseInt(star.dataset.value);
                if (starValue <= Math.round(averageRating)) {
                    star.style.color = 'rgb(250 204 21)';
                } else {
                    star.style.color = '#ccc';
                }
            });

        } catch (error) {
            console.error('Error fetching data:', error);
            // Fallback to static data if server is unreachable
            document.querySelector('.downloads-count').textContent = '921+ downloads';
            document.querySelector('.total-ratings').textContent = '5/5 (590 ratings)';
        }
    };

    // --- Event Listeners ---

    // Handle download button clicks
   document.querySelectorAll('.download-btn').forEach(button => {
        button.addEventListener('click', async (e) => {
            // Prevent the default download action to handle it with JavaScript
            e.preventDefault();

            const version = e.target.dataset.version;
            const downloadUrl = e.target.href;

            // Track the download first
            if (version) {
                try {
                    await fetch(`${serverUrl}/api/download`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ version })
                    });
                    
                    // Update the stats after a small delay
                    setTimeout(fetchStats, 500); 

                } catch (error) {
                    console.error('Error tracking download:', error);
                    // If tracking fails, the download will still proceed
                }
            }

            // Open the download URL in a new window/tab to ensure it starts
            window.open(downloadUrl, '_blank');
        });
    });

    // Handle rating submission
    document.getElementById('submit-rating').addEventListener('click', async () => {
        const ratingValue = document.getElementById('rating-value').value;
        if (ratingValue > 0) {
            try {
                await fetch(`${serverUrl}/api/rating`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ value: parseInt(ratingValue) })
                });
                alert('Thank you for your rating!');
                // Update stats after a small delay
                setTimeout(fetchStats, 500); 
            } catch (error) {
                console.error('Error submitting rating:', error);
                alert('Error submitting rating. Please try again later.');
            }
        } else {
            alert('Please select a star rating first.');
        }
    });

    // Handle star clicks for rating selection
    const stars = document.querySelectorAll('.star');
    const ratingInput = document.getElementById('rating-value');
    stars.forEach(star => {
        star.addEventListener('click', () => {
            const value = star.dataset.value;
            ratingInput.value = value;
            stars.forEach(s => {
                s.style.color = s.dataset.value <= value ? 'rgb(250 204 21)' : '#4b5563';
            });
        });
    });

    // --- Initial Load ---
    fetchStats();
});
</script>
<script src="main.js"></script>

<footer>
    <p>&copy; 2024 DHR Store. All rights reserved.</p>
</footer>

</body>
</html>